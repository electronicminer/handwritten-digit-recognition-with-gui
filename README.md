# handwritten-digit-recognition-with-gui
Handwritten Digit Recognition | Python + Tkinter + PyTorch | MNIST CNN Model​

# python手写数字识别课程设计

## 1. 需求分析

本系统旨在实现一个完整的手写数字识别工具，具备如下功能：

* 识别单张手写数字图片的数字。
* 识别图像中多个手写数字，进行切割与批量预测。
* 支持图形用户界面（GUI）输入图片并显示预测结果。
* 提供摄像头实时识别（可选）。
* 支持模型训练、测试、准确率评估与混淆矩阵可视化。

## 2. 总体框架设计

系统整体结构如图所示：

```
+-------------------+
|     用户界面      |
|  (Tkinter GUI)    |
+-------------------+
           ↓
+---------------------------+
|      图像预处理模块       |
| - 灰度化与对比度增强      |
| - 图像二值化与去噪        |
| - 数字图像居中与缩放      |
+---------------------------+
           ↓
+-------------------+
|    数字切割模块    |
| (cv2轮廓检测分割) |
+-------------------+
           ↓
+-------------------+
|    数字识别模型    |
|    (CNN+PyTorch)   |
+-------------------+
           ↓
+-------------------+
|    结果显示模块    |
+-------------------+
```

## 3. 功能详细设计

### 3.1 图像预处理

为了提升准确率，在实际识别过程中对图像进行了如下处理：

* 使用 `PIL.ImageEnhance.Contrast` 提高图像对比度，使手写笔迹更明显。
* 将图像转换为灰度图后进行二值化处理，突出手写内容，去除背景干扰。
* 使用图像边界裁剪提取有效区域。
* 将图像统一缩放至 20x20，粘贴到 28x28 黑底画布中，并利用图像几何中心进行居中处理，使其更贴近 MNIST 风格。

该模块的核心函数是 `preprocess_and_center`，对外部图像进行一系列标准化和格式转换，提升模型预测准确率。

### 3.2 数字切割

识别含多个数字的图像时，使用 OpenCV 进行如下处理：

* 图像灰度转换与二值化处理；
* 使用 `cv2.findContours` 查找外轮廓；
* 使用 `cv2.boundingRect` 获取最小外接矩形；
* 按照 x 坐标对所有矩形排序，从而获取数字的正确排列顺序；
* 对每个区域分别进行预处理后送入模型预测。

### 3.3 CNN模型

CNN 模型结构如下：

```
输入：1×28×28 灰度图
 ↓ Conv2d(1, 32, 3) + ReLU + MaxPool
 ↓ Conv2d(32, 64, 3) + ReLU + MaxPool
 ↓ Flatten → Linear(3136, 128) → Dropout(0.5) → ReLU
 ↓ Linear(128, 10) → 输出 10 类别概率
```

模型使用 ReLU 激活函数和 Dropout 正则化以防止过拟合。

### 3.4 模型训练

训练使用 `train.py` 脚本实现，关键设计如下：

* 使用 MNIST 数据集进行训练与测试；
* 使用 `Adam` 优化器，初始学习率为 0.05；
* 增加 `RandomRotation` 数据增强操作提升泛化能力；
* 每轮训练后在测试集上评估模型性能，保存最佳模型；
* 使用 `CrossEntropyLoss` 作为损失函数；

最终模型测试准确率可达 98.86%。训练期间使用如下代码片段：

```python
transform = transforms.Compose([
    transforms.Grayscale(),
    transforms.Resize((28, 28)),
    transforms.ToTensor(),
    transforms.RandomRotation(degrees=10),
    transforms.Normalize((0.1307,), (0.3081,))
])
```

并提供模型训练日志与准确率输出。

### 3.5 混淆矩阵分析

训练完成后，对模型在测试集上的表现进行混淆矩阵评估。
使用 seaborn 进行可视化分析，如图所示：

![confusion matrix](https://github.com/electronicminer/handwritten-digit-recognition-with-gui/raw/main/docs/confusion_matrix_example.png)

该图展示模型对各数字分类的准确性，有助于定位混淆易发区域。

### 3.6 图形用户界面

使用 Tkinter 实现图形界面，包括：

* 按钮：加载图像、识别数字、清除内容；
* 图像展示区域：显示用户选择或绘制的图片；
* 预测结果显示：展示每一位数字的识别结果。

GUI 模块与模型预测模块解耦，界面友好，适合非技术用户使用。

## 4. 测试验证

通过以下方式进行了测试：

* 单图识别：对用户上传的图片进行预处理和预测；
* 多数字识别：自动分割图像中的多个数字并逐个预测；
* 摄像头识别：通过摄像头实时捕捉画面并在指定区域内识别数字（受环境影响大）；
* 测试集评估：在 MNIST 官方测试集上达到了 98.86% 的识别准确率。

## 5. 总结

本项目完整实现了一个基于 CNN 的手写数字识别系统，涵盖了图像预处理、模型训练、图像分割、图形界面等多个模块。

在开发过程中，针对原始图像中非标准数字风格导致识别准确率低的问题，特别引入了图像增强、中心对齐等预处理方法，使模型更好地适应真实场景。
